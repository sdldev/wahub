# Development Dockerfile dengan hot reload
FROM node:20-alpine

# Install dumb-init
RUN apk add --no-cache dumb-init

# Set working directory
WORKDIR /app

# Install pnpm
RUN npm install -g pnpm

# Copy package files
COPY package*.json ./
COPY pnpm-lock.yaml ./

# Install all dependencies (including dev dependencies)
RUN pnpm install --frozen-lockfile

# Create directories
RUN mkdir -p /app/wa_credentials /app/media /app/data /app/logs

# Expose port
EXPOSE 5001

# Start with hot reload
ENTRYPOINT ["dumb-init", "--"]
CMD ["pnpm", "run", "dev"]